<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Project Table</title>

    <style>
        @font-face {
            font-family: "Helvetica";
            src: url("../assets/fonts/Helvetica.ttf") format("truetype");
        }

        @font-face {
            font-family: "Helvetica Bold";
            src: url("../assets/fonts/Helvetica-Bold.ttf") format("truetype");
        }

        @font-face {
            font-family: "Helvetica Oblique";
            src: url("../assets/fonts/Helvetica-Oblique.ttf") format("truetype");
        }

        body {
            margin: 0;
            font-family: Helvetica, sans-serif;
            background-color: black;
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            font-size: 10px;
            user-select: none;
        }

        .container {
            display: grid;
            grid-template-columns: 1.5fr 2fr;
            height: 80%;
            width: 90%;
            gap: 40px;
        }

        .image {
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }

        .image img {
            width: 100%;
            height: 600px;
            object-fit: cover;
            display: none;
        }

        /* Dynamic Text Overlay */
        #dynamicText {
            font-family: "Helvetica", sans-serif;
            letter-spacing: 2px;
            position: absolute;
            bottom: 20px;
            /* Positioning at the bottom */
            left: 50%;
            transform: translateX(-50%);
            /* Center the text horizontally */
            font-size: 2rem;
            font-weight: 500;
            color: white;
            text-shadow: 2px 2px 5px rgba(0, 0, 0, 0.7);
            /* Adds a shadow for visibility */
            padding: 10px;
            border-radius: 5px;
        }

        .table {
            padding: 0px;
            overflow-y: auto;
        }

        .table table {
            width: 100%;
            border-collapse: collapse;
        }

        .table table th,
        .table table td {
            padding: 8px;
            text-align: left;
            border-bottom: 1px solid #3d3d3d;
            color: #3d3d3d;
        }

        .table table tr:hover {
            cursor: pointer;
            color: white;
        }

        .table table tr:hover td {
            color: aliceblue;
        }

        .text-mode .table table tr:hover td {
            color: rgba(77, 73, 73, 0.322);
        }

        .expanded-row {
            display: none;
            transition: 0.5s ease-in-out;
        }

        .expanded-row img {
            width: 100%;
            height: 80px;
            object-fit: cover;
            cursor: pointer;
            transition: 0.5s ease-in-out;
        }

        .image-gallery {
            display: flex;
            overflow-x: auto;
            padding: 10px;
            max-width: 100%;
            scrollbar-width: none;
        }

        .image-gallery::-webkit-scrollbar {
            display: none;
        }

        /* Dark Mode */
        .dark-mode {
            background-color: black;
            color: white;
        }

        .extra {
            color: #e5e0e0ba !important;
        }

        /* Text Mode */
        .text-mode {
            background-color: white;
            color: black;
            font-family: "Helvetica", sans-serif;
        }

        /* Monochrome Mode */
        .monochrome-mode {
            filter: grayscale(100%);
        }

        ::-webkit-scrollbar {
            width: 0;
            height: 0;
        }

        * {
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        .sort-text {
            position: relative;
            left: -40%;
        }

        .expandButton {
            position: relative !important;
        }

        .image {
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .holder {
            width: 100%;
            justify-content: space-between;
            display: flex;
            position: absolute;
            bottom: -10px !important;
            z-index: 600 !important;
            background-color: rgb(0, 0, 0);
            color: #3d3d3d;
        }
    </style>

    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/locomotive-scroll/4.1.4/locomotive-scroll.min.css" />
</head>

<body>
    <div class="container">
        <div class="image" id="imageDisplay">
            <img id="dynamicImage" src="" alt="" style="display: none;" />
            <p id="dynamicText"></p>
            <div class="holder">
                <p id="projectName"> </p>
                <p id="location"> </p>
                <p id="typology"> </p>
                <p id="year"> </p>
            </div>
        </div>
        <div class="table" data-scroll-container>
            <table data-scroll-container>
                <thead>
                    <tr>
                        <th id="expandButton" class="extra">
                            <span id="expandText">expand [N]</span>
                        </th>
                        <th class="extra">
                            location
                            <span class="sort-text" id="sortButton">sort</span>
                        </th>
                        <th>typology</th>
                        <th>status</th>
                        <th>year</th> <!-- Year column to be sorted -->
                    </tr>
                </thead>

                <tbody>
                    <tr data-project-name="R320" onclick="handleRowClick(this)"
                        onmouseover="showImage('https://ik.imagekit.io/7da6fpjdo/staap/r320/render1-min.png?updatedAt=1735040722348','R320')"
                        onmouseout="hideImage()">
                        <td>R320</td>
                        <td>OMR, Chennai</td>
                        <td>Commercial</td>
                        <td>Completed</td>
                        <td>2022</td>
                    </tr>
                    <tr class="expanded-row tr-expanded">
                        <td colspan="5">
                            <div class="image-gallery">
                                <img src="https://ik.imagekit.io/7da6fpjdo/staap/r320/render1-min.png?updatedAt=1735040722348"
                                    alt="Random Image 1" onmouseover="showImage(this.src,'R320')"
                                    onclick="clickImage(this.src)">
                                <img src="https://ik.imagekit.io/7da6fpjdo/staap/r320/03-min.jpg?updatedAt=1735040788597"
                                    alt="Random Image 1" onmouseover="showImage(this.src,'R320')"
                                    onclick="clickImage(this.src)">
                                <img src="https://ik.imagekit.io/7da6fpjdo/staap/r320/04-min.jpg?updatedAt=1735040736394"
                                    alt="Random Image 1" onmouseover="showImage(this.src,'R320')"
                                    onclick="clickImage(this.src)">
                                <img src="https://ik.imagekit.io/7da6fpjdo/staap/r320/02-min%20(1).jpg?updatedAt=1735040770563"
                                    alt="Random Image 1" onmouseover="showImage(this.src,'R320')"
                                    onclick="clickImage(this.src)">
                                <img src="https://ik.imagekit.io/7da6fpjdo/staap/r320/05-min.jpg?updatedAt=1735040760997"
                                    alt="Random Image 1" onmouseover="showImage(this.src,'R320')"
                                    onclick="clickImage(this.src)">
                            </div>
                        </td>
                    </tr>
                    <tr data-project-name="Panache" onclick="handleRowClick(this)"
                        onmouseover="showImage('https://ik.imagekit.io/7da6fpjdo/staap/panche/02.2-min.jpg?updatedAt=1735039058432','Panache')"
                        onmouseout="hideImage()">
                        <td>Panache</td>
                        <td>Avadi, Chennai</td>
                        <td>Commercial</td>
                        <td>Completed</td>
                        <td>2023</td>
                    </tr>
                    <tr class="expanded-row exp">
                        <td colspan="5">
                            <div class="image-gallery">
                                <img src="https://ik.imagekit.io/7da6fpjdo/staap/panche/02.2-min.jpg?updatedAt=1735039058432"
                                    alt="Random Image 1" onmouseover="showImage(this.src,'Panache')"
                                    onclick="clickImage(this.src)">
                                <img src="https://ik.imagekit.io/7da6fpjdo/staap/panche/02.1-min.jpg?updatedAt=1735039183239"
                                    alt="Random Image 1" onmouseover="showImage(this.src,'Panache')"
                                    onclick="clickImage(this.src)">
                                <img src="https://ik.imagekit.io/7da6fpjdo/staap/panche/03.1-min.jpg?updatedAt=1735039268919"
                                    alt="Random Image 1" onmouseover="showImage(this.src,'Panache')"
                                    onclick="clickImage(this.src)">
                                <img src="https://ik.imagekit.io/7da6fpjdo/staap/panche/04.1-min.jpg?updatedAt=1735039471147"
                                    alt="Random Image 1" onmouseover="showImage(this.src,'Panache')"
                                    onclick="clickImage(this.src)">
                                <img src="https://ik.imagekit.io/7da6fpjdo/staap/panche/02-min.jpg?updatedAt=1735040233064"
                                    alt="Random Image 1" onmouseover="showImage(this.src,'Panache')"
                                    onclick="clickImage(this.src)">
                                <img src="https://ik.imagekit.io/7da6fpjdo/staap/panche/01-min.jpg?updatedAt=1735040313886"
                                    alt="Random Image 1" onmouseover="showImage(this.src,'Panache')"
                                    onclick="clickImage(this.src)">
                                <img src="https://ik.imagekit.io/7da6fpjdo/staap/panche/001-min.jpg?updatedAt=1735040572002"
                                    alt="Random Image 1" onmouseover="showImage(this.src,'Panache')"
                                    onclick="clickImage(this.src)">
                            </div>
                        </td>
                    </tr>
                    <tr data-project-name="Smart-Living" onclick="handleRowClick(this)"
                        onmouseover="showImage('https://ik.imagekit.io/7da6fpjdo/staap/Smart%20Living/Snapinsta.app_334480343_923198865475229_2361516323191347728_n_1080.jpg?updatedAt=1735036985692','Smart Living')"
                        onmouseout="hideImage()">
                        <td>Smart Living</td>
                        <td>Ashok Nagar, Chennai</td>
                        <td>Commercial</td>
                        <td>Completed</td>
                        <td>2023</td>
                    </tr>
                    <tr class="expanded-row exp">
                        <td colspan="5">
                            <div class="image-gallery" style=" overflow: hidden;">
                                <img src="https://ik.imagekit.io/7da6fpjdo/staap/Smart%20Living/Snapinsta.app_334480343_923198865475229_2361516323191347728_n_1080.jpg?updatedAt=1735036985692"
                                    onmouseover="showImage(this.src,'Smart Living')" alt="Random Image 1"
                                    onclick="clickImage(this.src)">
                                <img src="https://ik.imagekit.io/7da6fpjdo/staap/Smart%20Living/Snapinsta.app_332519335_190625283610219_1735237496296524848_n_1080.jpg?updatedAt=1735036981815"
                                    onmouseover="showImage(this.src,'Smart Living')" alt="Random Image 1"
                                    onclick="clickImage(this.src)">
                                <img src="https://ik.imagekit.io/7da6fpjdo/staap/Smart%20Living/Snapinsta.app_334029200_1555549094966275_4037171488500879929_n_1080.jpg?updatedAt=1735036981683"
                                    onmouseover="showImage(this.src,'Smart Living')" alt="Random Image 1"
                                    onclick="clickImage(this.src)">
                                <img src="https://ik.imagekit.io/7da6fpjdo/staap/Smart%20Living/Snapinsta.app_334183935_885478069384950_7429898028351870087_n_1080.jpg?updatedAt=1735036985016"
                                    onmouseover="showImage(this.src,'Smart Living')" alt="Random Image 1"
                                    onclick="clickImage(this.src)">
                                <img src="https://ik.imagekit.io/7da6fpjdo/staap/Smart%20Living/Snapinsta.app_333901174_751077386544912_5196671392992607612_n_1080.jpg?updatedAt=1735036981627"
                                    onmouseover="showImage(this.src,'Smart Living')" alt="Random Image 1"
                                    onclick="clickImage(this.src)">
                                <img src="https://ik.imagekit.io/7da6fpjdo/staap/Smart%20Living/Snapinsta.app_334171035_176310921832606_186646504429044769_n_1080.jpg?updatedAt=1735036984861"
                                    onmouseover="showImage(this.src,'Smart Living')" alt="Random Image 1"
                                    onclick="clickImage(this.src)">
                                <img src="https://ik.imagekit.io/7da6fpjdo/staap/Smart%20Living/Snapinsta.app_331336902_749962663151007_2747585324238393790_n_1080.jpg?updatedAt=1735036981788"
                                    onmouseover="showImage(this.src,'Smart Living')" alt="Random Image 1"
                                    onclick="clickImage(this.src)">
                                <img src="https://ik.imagekit.io/7da6fpjdo/staap/Smart%20Living/eaabed164753257.63fcdaaae8d40.jpg?updatedAt=1735036982052"
                                    alt="Random Image 1" onmouseover="showImage(this.src,'Smart Living')"
                                    onclick="clickImage(this.src)">
                            </div>
                        </td>
                    </tr>
                    <tr data-project-name="R320" onclick="handleRowClick(this)"
                        onmouseover="showImage('https://ik.imagekit.io/7da6fpjdo/staap/r320/render1-min.png?updatedAt=1735040722348','R320')"
                        onmouseout="hideImage()">
                        <td>R320</td>
                        <td>OMR, Chennai</td>
                        <td>Commercial</td>
                        <td>Completed</td>
                        <td>2022</td>
                    </tr>
                    <tr class="expanded-row tr-expanded">
                        <td colspan="5">
                            <div class="image-gallery">
                                <img src="https://ik.imagekit.io/7da6fpjdo/staap/r320/render1-min.png?updatedAt=1735040722348"
                                    alt="Random Image 1" onmouseover="showImage(this.src,'R320')"
                                    onclick="clickImage(this.src)">
                                <img src="https://ik.imagekit.io/7da6fpjdo/staap/r320/03-min.jpg?updatedAt=1735040788597"
                                    alt="Random Image 1" onmouseover="showImage(this.src,'R320')"
                                    onclick="clickImage(this.src)">
                                <img src="https://ik.imagekit.io/7da6fpjdo/staap/r320/04-min.jpg?updatedAt=1735040736394"
                                    alt="Random Image 1" onmouseover="showImage(this.src,'R320')"
                                    onclick="clickImage(this.src)">
                                <img src="https://ik.imagekit.io/7da6fpjdo/staap/r320/02-min%20(1).jpg?updatedAt=1735040770563"
                                    alt="Random Image 1" onmouseover="showImage(this.src,'R320')"
                                    onclick="clickImage(this.src)">
                                <img src="https://ik.imagekit.io/7da6fpjdo/staap/r320/05-min.jpg?updatedAt=1735040760997"
                                    alt="Random Image 1" onmouseover="showImage(this.src,'R320')"
                                    onclick="clickImage(this.src)">
                            </div>
                        </td>
                    </tr>
                </tbody>

            </table>

        </div>
    </div>
    <style>
        /* Add styles for the active row */
        .active-row td {
            color: white !important;
        }

        .text-mode .active-row td {
            color: black !important;
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/locomotive-scroll/4.1.4/locomotive-scroll.min.js"></script>

    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const theme = urlParams.get("theme");

        if (theme) {
            document.body.className = `${theme}-mode`;

        }

        //         document.addEventListener("DOMContentLoaded", () => {
        //   // Initialize Locomotive Scroll
        //   const scroll = new LocomotiveScroll({
        //     el: document.querySelector("[data-scroll-container]"),
        //     smooth: true,
        //     multiplier: 1, // Adjust scroll speed multiplier
        //     smartphone: {
        //       smooth: true,
        //     },
        //     tablet: {
        //       smooth: true,
        //     },
        //   });

        //   // Optional: Update Locomotive Scroll on Content Change
        //   scroll.update();
        // });

    </script>
    <script>
        let isSortedAscending = true; // Track sorting order

        // Function to sort rows by the Year column (5th column)
        function sortRowsByYear() {
            const tableBody = document.querySelector('.table tbody');

            // Get all row pairs (main row + expanded row)
            const rowPairs = [];
            const allRows = Array.from(tableBody.rows);

            // Group rows into pairs
            for (let i = 0; i < allRows.length; i += 2) {
                if (allRows[i] && allRows[i + 1]) {
                    rowPairs.push({
                        mainRow: allRows[i],
                        expandedRow: allRows[i + 1]
                    });
                }
            }

            // Sort the pairs based on the year in the main row
            rowPairs.sort((a, b) => {
                const yearA = parseInt(a.mainRow.cells[4].textContent.trim());
                const yearB = parseInt(b.mainRow.cells[4].textContent.trim());
                return isSortedAscending ? yearA - yearB : yearB - yearA;
            });

            // Clear the table
            while (tableBody.firstChild) {
                tableBody.removeChild(tableBody.firstChild);
            }

            // Re-append the sorted pairs
            rowPairs.forEach(pair => {
                tableBody.appendChild(pair.mainRow);
                tableBody.appendChild(pair.expandedRow);
            });

            // Toggle sorting order for next click
            isSortedAscending = !isSortedAscending;

            // Update sort button text based on order
            document.getElementById('sortButton').textContent =
                isSortedAscending ? 'sort' : 'sort';
        }

        // Attach event listener to the sort button for sorting
        document.getElementById('sortButton').addEventListener('click', sortRowsByYear);

        // Rest of your existing code remains the same
        const dynamicImage = document.getElementById('dynamicImage');
        const dynamicText = document.getElementById('dynamicText');

        function showImage(src, text = '') {
            dynamicImage.src = src || '';
            dynamicImage.style.display = src ? 'block' : 'none';
            dynamicText.textContent = text || '';
        }

        function hideImage() {
            showImage('');
        }

        function handleRowClick(row) {
    const projectName = row.getAttribute('data-project-name');
    if (projectName) {
        // Remove any existing .html and add it back to ensure proper extension
        const urlWithExtension = `/${projectName.replace('.html', '')}.html`;
        
        if (window.self !== window.top) {
            // We're in an iframe, so navigate the parent window
            window.parent.location.href = urlWithExtension;
        } else {
            // Direct navigation if not in iframe
            window.location.href = urlWithExtension;
        }
    }
}

// Attach event listener to rows for redirection
document.querySelectorAll('.table tbody tr').forEach(row => {
    if (!row.classList.contains('expanded-row')) { // Only attach to main rows, not expanded rows
        row.addEventListener('click', e => {
            e.preventDefault(); // Prevent default behavior
            e.stopPropagation(); // Prevent event bubbling
            handleRowClick(row);
        });
    }
});

        let areRowsExpanded = false;

        function toggleRows() {
            const rows = document.querySelectorAll('.table tbody tr');

            rows.forEach(row => {
                const nextRow = row.nextElementSibling;
                if (nextRow && nextRow.classList.contains('expanded-row')) {
                    nextRow.style.display = areRowsExpanded ? 'none' : 'table-row';
                    row.classList.toggle('active-row', !areRowsExpanded);
                    if (!areRowsExpanded) {
                        const imageSrc = row.getAttribute('data-image');
                        showImage(imageSrc, row.getAttribute('data-text'));
                    } else {
                        hideImage();
                    }
                }
            });

            areRowsExpanded = !areRowsExpanded;
            document.getElementById('expandText').textContent =
                areRowsExpanded ? 'expand [Y]' : 'expand [N]';
        }

        // Attach event listener to the expand button
        document.getElementById('expandButton').addEventListener('click', toggleRows);

        // Attach event listener to rows for redirection
        document.querySelectorAll('.table tbody tr').forEach(row => {
            row.addEventListener('click', e => {
                e.stopPropagation(); // Prevent triggering parent click events
                handleRowClick(row);
            });
        });
    </script>




</body>

</html>